<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CurvePointMapper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">spring-boot-skeleton</a> &gt; <a href="index.source.html" class="el_package">com.nnk.springboot.mapper</a> &gt; <span class="el_source">CurvePointMapper.java</span></div><h1>CurvePointMapper.java</h1><pre class="source lang-java linenums">package com.nnk.springboot.mapper;

import com.nnk.springboot.domain.CurvePoint;
import com.nnk.springboot.dto.CurvePointDTO;
import org.springframework.stereotype.Component;

/**
 * Mapper Spring pour la conversion entre entités CurvePoint et DTOs CurvePointDTO.
 * 
 * &lt;p&gt;Cette classe composant Spring implémente le pattern Mapper pour assurer la conversion
 * bidirectionnelle entre la couche de persistance (entités JPA) et la couche de
 * présentation (DTOs) spécifiquement pour les points de courbes financières.&lt;/p&gt;
 * 
 * &lt;p&gt;Spécificités des courbes financières :&lt;/p&gt;
 * &lt;ul&gt;
 *   &lt;li&gt;&lt;strong&gt;Données critiques&lt;/strong&gt; : Précision requise pour les calculs quantitatifs&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;Intégrité référentielle&lt;/strong&gt; : Validation des IDs de courbe&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;Cohérence temporelle&lt;/strong&gt; : Gestion des termes et échéances&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;Performance&lt;/strong&gt; : Optimisé pour le traitement de masse de points&lt;/li&gt;
 * &lt;/ul&gt;
 * 
 * &lt;p&gt;Architecture et principes SOLID :&lt;/p&gt;
 * &lt;ul&gt;
 *   &lt;li&gt;&lt;strong&gt;SRP&lt;/strong&gt; : Responsabilité unique de conversion CurvePoint&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;OCP&lt;/strong&gt; : Extensible via l'interface IEntityMapper&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;LSP&lt;/strong&gt; : Substitution respectée pour l'interface&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;ISP&lt;/strong&gt; : Interface spécialisée pour les mappings&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;DIP&lt;/strong&gt; : Dépendance sur l'abstraction IEntityMapper&lt;/li&gt;
 * &lt;/ul&gt;
 * 
 * &lt;p&gt;Fonctionnalités avancées :&lt;/p&gt;
 * &lt;ul&gt;
 *   &lt;li&gt;&lt;strong&gt;Conversion complète&lt;/strong&gt; : Entity ↔ DTO bidirectionnelle&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;Mise à jour in-place&lt;/strong&gt; : Optimisation pour les modifications&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;Gestion défensive&lt;/strong&gt; : Protection contre les valeurs null&lt;/li&gt;
 *   &lt;li&gt;&lt;strong&gt;Injection Spring&lt;/strong&gt; : Composant géré par le conteneur IoC&lt;/li&gt;
 * &lt;/ul&gt;
 * 
 * &lt;p&gt;Usage typique dans l'écosystème financier :&lt;/p&gt;
 * &lt;pre&gt;
 * // Construction d'une courbe de taux
 * &amp;#64;Autowired
 * private CurvePointMapper mapper;
 * 
 * // Affichage d'une courbe
 * List&amp;lt;CurvePoint&amp;gt; points = curveService.findByCurveId(1);
 * List&amp;lt;CurvePointDTO&amp;gt; dtos = points.stream()
 *     .map(mapper::toDTO)
 *     .collect(Collectors.toList());
 * 
 * // Mise à jour d'un point
 * CurvePoint existing = curveService.findById(id);
 * mapper.updateEntityFromDTO(existing, modifiedDTO);
 * curveService.save(existing);
 * &lt;/pre&gt;
 * 
 * @author Poseidon Trading App
 * @version 1.0
 * @since 1.0
 * @see com.nnk.springboot.domain.CurvePoint
 * @see com.nnk.springboot.dto.CurvePointDTO
 * @see IEntityMapper
 */
@Component
<span class="fc" id="L65">public class CurvePointMapper implements IEntityMapper&lt;CurvePoint, CurvePointDTO&gt; {</span>

    /**
     * Convertit une entité CurvePoint en DTO CurvePointDTO.
     * 
     * &lt;p&gt;Cette méthode transforme une entité JPA de point de courbe en objet
     * de transfert de données pour l'affichage et la manipulation dans les vues.
     * Elle préserve l'intégrité des données financières critiques.&lt;/p&gt;
     * 
     * &lt;p&gt;Données mappées :&lt;/p&gt;
     * &lt;ul&gt;
     *   &lt;li&gt;&lt;strong&gt;id&lt;/strong&gt; : Identifiant unique du point&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;curveId&lt;/strong&gt; : Référence vers la courbe parent&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;term&lt;/strong&gt; : Échéance en années (précision 4 décimales)&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;value&lt;/strong&gt; : Valeur financière (taux, volatilité, etc.)&lt;/li&gt;
     * &lt;/ul&gt;
     * 
     * &lt;p&gt;Cas d'usage financiers :&lt;/p&gt;
     * &lt;ul&gt;
     *   &lt;li&gt;&lt;strong&gt;Affichage de courbes&lt;/strong&gt; : Visualisation graphique&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Export de données&lt;/strong&gt; : Rapports et fichiers CSV/Excel&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;API REST&lt;/strong&gt; : Sérialisation JSON pour clients externes&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Validation utilisateur&lt;/strong&gt; : Pré-remplissage de formulaires&lt;/li&gt;
     * &lt;/ul&gt;
     * 
     * @param curvePoint L'entité CurvePoint à convertir (peut être null)
     * @return Le DTO CurvePointDTO correspondant, ou null si l'entité source est null
     * @throws aucune exception n'est levée (gestion défensive)
     */
    public CurvePointDTO toDTO(CurvePoint curvePoint) {
<span class="fc bfc" id="L95" title="All 2 branches covered.">        if (curvePoint == null) {</span>
<span class="fc" id="L96">            return null;</span>
        }

<span class="fc" id="L99">        CurvePointDTO dto = new CurvePointDTO();</span>
<span class="fc" id="L100">        dto.setId(curvePoint.getId());</span>
<span class="fc" id="L101">        dto.setCurveId(curvePoint.getCurveId());</span>
<span class="fc" id="L102">        dto.setTerm(curvePoint.getTerm());</span>
<span class="fc" id="L103">        dto.setValue(curvePoint.getValue());</span>

<span class="fc" id="L105">        return dto;</span>
    }

    /**
     * Convertit un DTO CurvePointDTO en entité CurvePoint.
     * 
     * &lt;p&gt;Cette méthode transforme un objet de transfert de données (provenant
     * généralement d'un formulaire web ou d'une API) en entité JPA prête pour
     * la persistance. Elle assure la cohérence des données financières critiques.&lt;/p&gt;
     * 
     * &lt;p&gt;Validation et intégrité :&lt;/p&gt;
     * &lt;ul&gt;
     *   &lt;li&gt;&lt;strong&gt;Précision numérique&lt;/strong&gt; : Préservation des 4 décimales&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Cohérence référentielle&lt;/strong&gt; : CurveId valide requis&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Intégrité temporelle&lt;/strong&gt; : Term positif ou nul&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Validation déléguée&lt;/strong&gt; : Bean Validation effectuée côté DTO&lt;/li&gt;
     * &lt;/ul&gt;
     * 
     * &lt;p&gt;Cas d'usage financiers :&lt;/p&gt;
     * &lt;ul&gt;
     *   &lt;li&gt;&lt;strong&gt;Création de points&lt;/strong&gt; : Nouveaux points depuis interface&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Import de courbes&lt;/strong&gt; : Chargement de données de marché&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Calibration de modèles&lt;/strong&gt; : Points calculés algorithmiquement&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;API REST&lt;/strong&gt; : Réception de données JSON&lt;/li&gt;
     * &lt;/ul&gt;
     * 
     * &lt;p&gt;Note : Les timestamps (asOfDate, creationDate) ne sont pas mappés car
     * ils sont gérés automatiquement par la logique métier et les listeners JPA.&lt;/p&gt;
     * 
     * @param dto Le DTO CurvePointDTO à convertir (peut être null)
     * @return L'entité CurvePoint correspondante, ou null si le DTO source est null
     * @throws aucune exception n'est levée (gestion défensive)
     */
    public CurvePoint toEntity(CurvePointDTO dto) {
<span class="fc bfc" id="L139" title="All 2 branches covered.">        if (dto == null) {</span>
<span class="fc" id="L140">            return null;</span>
        }

<span class="fc" id="L143">        CurvePoint curvePoint = new CurvePoint();</span>
<span class="fc" id="L144">        curvePoint.setId(dto.getId());</span>
<span class="fc" id="L145">        curvePoint.setCurveId(dto.getCurveId());</span>
<span class="fc" id="L146">        curvePoint.setTerm(dto.getTerm());</span>
<span class="fc" id="L147">        curvePoint.setValue(dto.getValue());</span>

<span class="fc" id="L149">        return curvePoint;</span>
    }

    /**
     * Met à jour une entité CurvePoint existante avec les données d'un DTO.
     * 
     * &lt;p&gt;Cette méthode optimisée effectue une mise à jour in-place d'une entité
     * existante sans créer de nouvelle instance. Elle est particulièrement efficace
     * pour les opérations de modification où l'entité est déjà chargée en session JPA.&lt;/p&gt;
     * 
     * &lt;p&gt;Avantages de la mise à jour in-place :&lt;/p&gt;
     * &lt;ul&gt;
     *   &lt;li&gt;&lt;strong&gt;Performance&lt;/strong&gt; : Évite la création d'objets inutiles&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Session JPA&lt;/strong&gt; : Préserve l'état de la session Hibernate&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Optimistic Locking&lt;/strong&gt; : Maintient la gestion des versions&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;Lazy Loading&lt;/strong&gt; : Préserve les associations chargées&lt;/li&gt;
     * &lt;/ul&gt;
     * 
     * &lt;p&gt;Champs mis à jour :&lt;/p&gt;
     * &lt;ul&gt;
     *   &lt;li&gt;&lt;strong&gt;curveId&lt;/strong&gt; : Peut changer de courbe (avec validation métier)&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;term&lt;/strong&gt; : Modification de l'échéance&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;value&lt;/strong&gt; : Nouvelle valeur financière&lt;/li&gt;
     * &lt;/ul&gt;
     * 
     * &lt;p&gt;Champs préservés :&lt;/p&gt;
     * &lt;ul&gt;
     *   &lt;li&gt;&lt;strong&gt;id&lt;/strong&gt; : Identifiant technique préservé&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;asOfDate&lt;/strong&gt; : Date de référence maintenue&lt;/li&gt;
     *   &lt;li&gt;&lt;strong&gt;creationDate&lt;/strong&gt; : Horodatage de création original&lt;/li&gt;
     * &lt;/ul&gt;
     * 
     * &lt;p&gt;Usage typique :&lt;/p&gt;
     * &lt;pre&gt;
     * // Modification d'un point existant
     * CurvePoint existing = curveService.findById(pointId);
     * CurvePointDTO modified = getModifiedDataFromForm();
     * 
     * curvePointMapper.updateEntityFromDTO(existing, modified);
     * curveService.save(existing); // Hibernate détecte les changements
     * &lt;/pre&gt;
     * 
     * @param existingCurvePoint L'entité existante à mettre à jour (ne doit pas être null en usage normal)
     * @param dto Le DTO contenant les nouvelles données (ne doit pas être null en usage normal)
     * @throws aucune exception n'est levée - protection défensive contre les nulls
     */
    public void updateEntityFromDTO(CurvePoint existingCurvePoint, CurvePointDTO dto) {
<span class="fc bfc" id="L196" title="All 4 branches covered.">        if (existingCurvePoint == null || dto == null) {</span>
<span class="fc" id="L197">            return;</span>
        }

<span class="fc" id="L200">        existingCurvePoint.setCurveId(dto.getCurveId());</span>
<span class="fc" id="L201">        existingCurvePoint.setTerm(dto.getTerm());</span>
<span class="fc" id="L202">        existingCurvePoint.setValue(dto.getValue());</span>
<span class="fc" id="L203">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>